{"componentChunkName":"component---src-templates-blog-post-js","path":"/bash-function-for-git-squash/","result":{"data":{"site":{"id":"Site","siteMetadata":{"title":"Ayan's Blog"}},"markdownRemark":{"id":"3a41333f-1d6e-5e43-8bfb-64d88f77c2a1","excerpt":"Cover photo by Moritz Kindler on Unsplash I often find myself squashing a lot of unnecessary commits. The usual way to do this is by using  or . I personally…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/12609/clock.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABBP/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAAB6ytZUrL/xAAYEAEAAwEAAAAAAAAAAAAAAAABAAIQEf/aAAgBAQABBQKUexMM/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAACBh/9oACAEBAAY/Air/AP/EABoQAAICAwAAAAAAAAAAAAAAAAABEBEhMUH/2gAIAQEAAT8hLVNUnDJG4z//2gAMAwEAAgADAAAAEAM//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgMBAQAAAAAAAAAAAAAAAREAIXEQQf/aAAgBAQABPxA1GbQLIKnWwBBjyPiaIyf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cover-image-for-git-squash\"\n        title=\"cover-image-for-git-squash\"\n        src=\"/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/1c72d/clock.jpg\"\n        srcset=\"/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/a80bd/clock.jpg 148w,\n/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/1c91a/clock.jpg 295w,\n/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/1c72d/clock.jpg 590w,\n/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/a8a14/clock.jpg 885w,\n/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/fbd2c/clock.jpg 1180w,\n/blog/static/286a1e76d3bb1d15a7fe9276fa6d5091/12609/clock.jpg 3000w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><small><i><span>Cover photo by <a href=\"https://unsplash.com/@moritz_photography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Moritz Kindler</a> on <a href=\"/s/photos/clock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Unsplash</a></span></i></small></p>\n<p>I often find myself squashing a lot of unnecessary commits. The usual way to do this is by using <code class=\"language-text\">rebase</code> or <code class=\"language-text\">soft reset</code>. I personally prefer to use the <code class=\"language-text\">soft reset</code> method.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># soft reset some commits</span>\n<span class=\"token function\">git</span> reset --soft HEAD~2\n<span class=\"token function\">git</span> commit -m <span class=\"token string\">\"Commit message\"</span></code></pre></div>\n<p>As you can see the process is rather long. So how we can save some precious seconds … enter bash functions!</p>\n<p>Add this function to your <code class=\"language-text\">.bashrc</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token keyword\">function</span> <span class=\"token function-name function\">sq</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -z <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">then</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"First argument required\"</span>\n        <span class=\"token builtin class-name\">return</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">fi</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -z <span class=\"token string\">\"<span class=\"token variable\">$2</span>\"</span> <span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">then</span>\n        <span class=\"token assign-left variable\">message</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> log --pretty<span class=\"token operator\">=</span>format:<span class=\"token string\">\"%B\"</span> -1<span class=\"token variable\">)</span></span>\"</span>\n    <span class=\"token keyword\">else</span>\n        <span class=\"token assign-left variable\">message</span><span class=\"token operator\">=</span><span class=\"token variable\">$2</span>\n    <span class=\"token keyword\">fi</span>\n    <span class=\"token function\">git</span> reset --soft HEAD~<span class=\"token variable\">$1</span>\n    <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"<span class=\"token variable\">$message</span>\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And then run <code class=\"language-text\">source ~/.bashrc</code>.</p>\n<h2>Usage</h2>\n<p>If you want to squash <code class=\"language-text\">2</code> commits with the commit message <code class=\"language-text\">Add tests</code>, run this: <code class=\"language-text\">sq 2 &quot;Add tests&quot;</code>.</p>\n<p>More often than not we want the commit message of the squashed commit to be the same as the recent most commit message. In those cases, simply run <code class=\"language-text\">sq 2</code> if you want to squash 2 commits.</p>\n<p>Sometimes we need to squash all the commits that we made after branching off from a branch. For that, add the following function to your <code class=\"language-text\">.bashrc</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token keyword\">function</span> <span class=\"token function-name function\">cnt</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token assign-left variable\">compare_branch</span><span class=\"token operator\">=</span><span class=\"token variable\">${1-master}</span>\n    <span class=\"token function\">git</span> rev-list --count HEAD ^<span class=\"token variable\">$compare_branch</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This gives the number of commits made after branching off. Try running <code class=\"language-text\">cnt</code> for the number of commits made after branching off from <code class=\"language-text\">master</code> and <code class=\"language-text\">cnt my_branch</code> for the number of commits made after branching off from <code class=\"language-text\">my_branch</code>. Don’t forget to run <code class=\"language-text\">source ~/.bashrc</code> after modifying <code class=\"language-text\">.bashrc</code>!</p>\n<p>Now simply run <code class=\"language-text\">sq &quot;$(cnt my_branch)&quot;</code> to squash the commits made after branching off from <code class=\"language-text\">my_branch</code> with the recent-most commit message.</p>\n<p>I hope that you have learned something useful from this post and save some seconds of your development time! Let me know if something is not clear.</p>\n<p><em>This post originally appeared on <a href=\"https://dev.to/ayanb/bash-function-for-git-squash-lno\">Dev</a></em>.</p>","frontmatter":{"title":"Bash Shortcut for Git Squash","date":"June 25, 2020","description":"Aka save seconds of your development time!"}}},"pageContext":{"slug":"/bash-function-for-git-squash/","previous":{"fields":{"slug":"/resume-generator/"},"frontmatter":{"title":"Generate a LaTeX Resume in Minutes"}},"next":null}}}